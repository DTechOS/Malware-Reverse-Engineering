import os
import pefile
from pathlib import Path
import pathlib
import ntpath

rootdir = '/Windows/SysWOW64'
for subdir, dirs, files in os.walk(rootdir):
    for filename in files:
      try:
        if filename.endswith(".dll"):
           paths = os.path.join(subdir,filename)
           full_path = paths.replace(ntpath.sep, pathlib.posixpath.sep)
           pe = pefile.PE(full_path)
           exports = [(exp.name) for exp in pe.DIRECTORY_ENTRY_EXPORT.symbols]
           print(filename, ":", exports)
      except:
        #print("failed to load file {}".format(filename))
        continue